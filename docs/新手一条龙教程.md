# 新手一条龙教程（超小白版｜从 0 到跑通一次调用）

> 目标：官网可访问 → 申请/领取 TRIAL_KEY → 用 curl 最小验证 → （可选）接入 OpenClaw。

- 网页版（最推荐，复制粘贴更舒服）：https://clawdrepublic.cn/quickstart.html
- TRIAL_KEY / quota-proxy 说明页（含管理员接口说明）：https://clawdrepublic.cn/quota-proxy.html
- 服务状态页：https://clawdrepublic.cn/status.html

> 仓库里的站点源文件在：`docs/site/`（用于审计与回滚）。

---

## 0) 你需要准备什么

- 一台能上网的电脑
- 一个终端
  - macOS/Linux：Terminal
  - Windows：PowerShell（也可以用 Windows Terminal）

> 下面命令默认以 macOS/Linux 为例；Windows PowerShell 的环境变量写法见第 3 步。

---

## 1) 先确认官网可访问

```bash
curl -fsS -m 5 https://clawdrepublic.cn/ > /dev/null && echo OK
```

如果失败：把报错全文复制到论坛求助帖里（别截断）。

---

## 2) 再确认 API 健康（不消耗额度）

```bash
curl -fsS -m 5 https://api.clawdrepublic.cn/healthz
```

你应该看到类似：

```json
{"ok":true}
```

---

## 3) 获取 TRIAL_KEY（当前：人工发放）

目前为了避免被滥用，TRIAL_KEY 先走人工发放。

- 去论坛发帖申请： https://clawdrepublic.cn/forum/
- 建议直接照抄模板帖的格式（用途/预计频率/模型偏好等）
- 管理员会发给你一个形如 `trial_...` 的 key

### 3.1 论坛使用指南

论坛是我们社区交流的核心平台，以下是使用建议：

**快速上手：**
1. **注册账号**：使用邮箱注册，建议使用常用邮箱以便接收通知
2. **查看置顶帖**：论坛首页有3个标准置顶帖：
   - 📚 新手入门指南 - 包含基础使用教程
   - 🔑 TRIAL_KEY申请模板 - 申请试用密钥的标准格式
   - 📝 发帖模板与规范 - 如何有效提问和分享

**发帖技巧：**
- **标题明确**：如"申请TRIAL_KEY用于个人学习项目"
- **内容完整**：包含用途说明、预计使用频率、偏好的模型等
- **代码格式化**：使用三个反引号包裹代码块
- **截图辅助**：遇到问题时，截图比文字描述更直观

**获取帮助：**
- 遇到技术问题 → 在"技术讨论"板块发帖
- 申请TRIAL_KEY → 在"密钥申请"板块发帖
- 分享经验 → 在"使用心得"板块发帖
- 建议反馈 → 在"建议反馈"板块发帖

**论坛验证命令：**
如果你部署了自己的论坛实例，可以使用项目中的验证脚本：
```bash
# 验证论坛HTTP可访问性
./scripts/quick-verify-forum.sh --url http://你的论坛地址

# 检查论坛服务状态
./scripts/check-forum-service.sh

# 初始化标准置顶帖
./scripts/init-forum-sticky-posts.sh --admin-email 你的管理员邮箱
```

---

## 4) 用 curl 做一次"最小验证"（会消耗试用额度）

### 4.1 设置环境变量

macOS/Linux（bash/zsh）：

```bash
export CLAWD_TRIAL_KEY='trial_xxx'
```

Windows PowerShell：

```powershell
$env:CLAWD_TRIAL_KEY='trial_xxx'
```

### 4.2 发起一次最小对话请求（OpenAI 兼容）

```bash
curl -fsS https://api.clawdrepublic.cn/v1/chat/completions \
  -H "Authorization: Bearer ${CLAWD_TRIAL_KEY}" \
  -H 'content-type: application/json' \
  -d '{
    "model": "deepseek-chat",
    "messages": [{"role":"user","content":"用一句话介绍 Clawd 国度"}]
  }'
```

成功标志：返回 JSON 里能看到 `choices` 字段。

---

## 5) （可选）把 TRIAL_KEY 接入 OpenClaw（最小可用）

> 说明：网页教程仍是最新版本：https://clawdrepublic.cn/quickstart.html
> 这一节给"只想复制粘贴跑起来"的最小配置。

### 5.1 安装 OpenClaw（如果还没安装）

如果你还没有安装 OpenClaw，可以使用以下命令安装：

#### 国内用户推荐（使用国内镜像源）：
```bash
# 方法一：使用官网提供的国内安装脚本（推荐）
curl -fsSL https://clawdrepublic.cn/install-cn.sh | bash

# 方法二：手动安装（如果方法一失败）
npm install -g openclaw --registry=https://registry.npmmirror.com
```

#### 国际用户或备用方案：
```bash
# 使用 npmjs 官方源
npm install -g openclaw
```

#### 验证安装：
```bash
openclaw --version
```
应该输出类似 `openclaw/0.3.12` 的版本信息。

> 如果遇到权限问题，可以尝试：
> - 使用 `sudo npm install -g openclaw`（不推荐，可能引起权限混乱）
> - 或使用 `nvm` 管理 Node.js 版本，避免全局安装权限问题

### 5.2 写入配置文件

把下面内容保存为：`~/.openclaw/openclaw.json`

```json
{
  "agents": {
    "defaults": {
      "model": { "primary": "clawd-gateway/deepseek-chat" },
      "models": {
        "clawd-gateway/deepseek-chat": {},
        "clawd-gateway/deepseek-reasoner": {}
      }
    }
  },
  "models": {
    "mode": "merge",
    "providers": {
      "clawd-gateway": {
        "baseUrl": "https://api.clawdrepublic.cn/v1",
        "apiKey": "${CLAWD_TRIAL_KEY}",
        "api": "openai-completions",
        "models": [
          { "id": "deepseek-chat", "name": "DeepSeek Chat" },
          { "id": "deepseek-reasoner", "name": "DeepSeek Reasoner" }
        ]
      }
    }
  }
}
```

### 5.3 启动网关并自检

```bash
openclaw gateway start
openclaw models status
```

如果你看到默认模型是 `clawd-gateway/...`，说明接入成功。

---

## 5.4 一键探活（推荐先跑一遍再发帖）

> 这些命令不需要 OpenClaw 正常工作也能跑，用来快速判断是「本地环境」还是「远端服务」的问题。

```bash
# 1) API 网关健康检查（应该返回：{"ok":true}）
curl -fsS -m 5 https://api.clawdrepublic.cn/healthz

# 2) 官网 quickstart 可达（应该返回 HTML）
curl -fsS -m 5 https://clawdrepublic.cn/quickstart.html | tail -n 3

# 3) 论坛可达（应该能匹配标题）
curl -fsS -m 5 https://clawdrepublic.cn/forum/ | grep -q 'Clawd 国度论坛' && echo forum:OK
```

如果你还能 SSH 到服务器（仅运维/自建部署需要），也可以探活 quota-proxy：

```bash
ssh -i ~/.ssh/id_ed25519_roc_server -o BatchMode=yes -o ConnectTimeout=8 root@8.210.185.194 'curl -fsS http://127.0.0.1:8787/healthz'
```

## 6) 常见报错怎么处理（复制粘贴这段到求助帖也行）

- `curl: (28) ... timeout`：网络不通/被拦/临时波动；请附上失败时间与命令全文
- `401/403`：TRIAL_KEY 不对/未开通/过期；请私信管理员核对
- `429`：超过当日试用次数上限（正常的限流行为）
- `5xx`：服务端异常；请附上失败时间、返回内容（不要脱敏掉整个返回）
