# 验证脚本索引

本文档提供中华AI共和国项目中所有验证脚本的索引和快速参考。

## 快速使用

```bash
# 查看所有验证脚本
ls -la scripts/verify-*.sh

# 运行特定验证脚本
./scripts/verify-<脚本名>.sh --help
./scripts/verify-<脚本名>.sh --dry-run  # 模拟运行
./scripts/verify-<脚本名>.sh --quick    # 快速验证
```

## 验证脚本列表

### 核心基础设施验证

| 脚本名称 | 功能描述 | 验证目标 | 创建时间 |
|---------|---------|---------|---------|
| `verify-quota-proxy.sh` | 配额代理服务验证 | quota-proxy Docker容器、健康检查、API端点 | 2026-02-11 |
| `verify-admin-comprehensive.sh` | 综合性管理API验证 | 健康检查、密钥管理、使用量统计、自动清理 | 2026-02-11 |
| `verify-verify-admin-comprehensive.sh` | 管理API验证脚本的验证 | 验证脚本自身的功能完整性 | 2026-02-11 |

### 数据库验证

| 脚本名称 | 功能描述 | 验证目标 | 创建时间 |
|---------|---------|---------|---------|
| `verify-db-performance-benchmark.sh` | 数据库性能基准测试验证 | 连接测试、查询性能、写入性能、并发性能 | 2026-02-11 |
| `check-server-backup-status.sh` | 服务器备份状态检查 | 备份文件存在性、完整性、时效性 | 2026-02-11 |
| `verify-check-server-backup-status.sh` | 备份状态检查脚本验证 | 验证脚本功能完整性 | 2026-02-11 |

### 站点部署验证

| 脚本名称 | 功能描述 | 验证目标 | 创建时间 |
|---------|---------|---------|---------|
| `verify-site-full-functionality.sh` | 站点完整功能性验证 | 7个方面完整验证（本地文件、landing page、安装脚本等） | 2026-02-11 |
| `verify-site-script-updates.sh` | 站点脚本更新验证 | install-cn.sh和verify-quickstart.sh功能验证 | 2026-02-11 |
| `verify-quickstart.sh` | 快速启动验证 | landing page、安装脚本、Caddy配置 | 2026-02-11 |

### 配置验证

| 脚本名称 | 功能描述 | 验证目标 | 创建时间 |
|---------|---------|---------|---------|
| `verify-env-config.sh` | 环境变量配置验证 | .env文件、配置加载、变量验证 | 2026-02-11 |

### 脚本验证（元验证）

| 脚本名称 | 功能描述 | 验证目标 | 创建时间 |
|---------|---------|---------|---------|
| `verify-verify-*.sh` 系列 | 验证脚本的验证 | 验证脚本自身的功能完整性、语法、帮助功能等 | 2026-02-11 |

## 验证模式说明

所有验证脚本支持以下通用模式：

### 1. 帮助模式 (`--help`)
显示脚本使用说明和参数选项。

```bash
./scripts/verify-*.sh --help
```

### 2. 模拟运行模式 (`--dry-run`)
执行模拟运行，不进行实际验证操作，仅显示将要执行的步骤。

```bash
./scripts/verify-*.sh --dry-run
```

### 3. 快速验证模式 (`--quick`)
执行快速验证，跳过耗时较长的测试项。

```bash
./scripts/verify-*.sh --quick
```

### 4. 详细模式 (`--verbose`)
显示详细的执行过程和调试信息。

```bash
./scripts/verify-*.sh --verbose
```

### 5. 静默模式 (`--silent`)
仅输出最终结果，不显示中间过程。

```bash
./scripts/verify-*.sh --silent
```

## 验证脚本设计模式

### 颜色日志系统
所有验证脚本使用统一的颜色日志系统：
- ✅ 绿色：成功/通过
- ⚠️ 黄色：警告/注意
- ❌ 红色：错误/失败
- 🔵 蓝色：信息/步骤
- 🟣 紫色：调试/详细信息

### 标准化函数库
验证脚本包含以下标准化函数：
- `log_info()`: 信息日志
- `log_success()`: 成功日志
- `log_warning()`: 警告日志
- `log_error()`: 错误日志
- `log_debug()`: 调试日志
- `check_dependencies()`: 依赖检查
- `cleanup()`: 清理函数
- `print_summary()`: 验证总结

### 测试报告格式
所有验证脚本生成标准化的测试报告：
```
========================================
验证报告：<脚本名称>
========================================
开始时间：YYYY-MM-DD HH:MM:SS
运行模式：dry-run/quick/full
========================================
测试项 1: [✅] 通过
测试项 2: [⚠️] 警告
测试项 3: [❌] 失败
========================================
总结：通过率 X/Y (XX%)
========================================
建议操作：
1. 修复失败项
2. 检查警告项
3. 重新运行验证
========================================
```

## 验证脚本开发指南

### 1. 创建新验证脚本
```bash
#!/bin/bash

# 验证脚本模板
source "$(dirname "$0")/../scripts/colors.sh"

SCRIPT_NAME="$(basename "$0")"

# 参数解析
parse_args() {
    while [[ $# -gt 0 ]]; do
        case $1 in
            --help|-h)
                show_help
                exit 0
                ;;
            --dry-run)
                DRY_RUN=true
                shift
                ;;
            --quick)
                QUICK_MODE=true
                shift
                ;;
            *)
                log_error "未知参数: $1"
                show_help
                exit 1
                ;;
        esac
    done
}

# 显示帮助
show_help() {
    cat << EOF
用法: $SCRIPT_NAME [选项]

选项:
  -h, --help     显示此帮助信息
  --dry-run      模拟运行，不执行实际验证
  --quick        快速验证模式
  --verbose      详细输出模式
  --silent       静默模式

示例:
  $SCRIPT_NAME --dry-run
  $SCRIPT_NAME --quick
EOF
}

# 主函数
main() {
    parse_args "$@"
    
    log_info "开始验证: $SCRIPT_NAME"
    
    # 验证逻辑
    test_case_1
    test_case_2
    test_case_3
    
    print_summary
}

# 运行主函数
main "$@"
```

### 2. 创建验证脚本的验证脚本
对于重要的验证脚本，创建对应的 `verify-verify-*.sh` 脚本进行元验证。

### 3. 更新索引
创建或更新验证脚本后，更新本文档。

## 故障排除

### 常见问题

1. **权限问题**
   ```bash
   chmod +x scripts/verify-*.sh
   ```

2. **依赖缺失**
   ```bash
   # 检查依赖
   ./scripts/verify-*.sh --dry-run
   ```

3. **语法错误**
   ```bash
   bash -n scripts/verify-*.sh
   ```

### 调试技巧

1. 使用 `set -x` 启用调试模式
2. 检查脚本执行权限
3. 验证环境变量设置
4. 查看日志文件

## 相关文档

- [验证脚本开发规范](./验证脚本开发规范.md)
- [颜色日志系统指南](./颜色日志系统指南.md)
- [测试报告模板](./测试报告模板.md)

---

**最后更新**: 2026-02-11 14:18:00 CST  
**维护者**: 中华AI共和国项目组  
**版本**: 1.0.0